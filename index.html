<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Liquid Mouse</title>
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            --accent: #00d2ff;
        }

        body {
            margin: 0;
            height: 100vh;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460); /* Sfondo scuro per risaltare il vetro */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', sans-serif;
            overflow: hidden;
            touch-action: none; /* Disabilita lo scroll nativo */
        }

        /* Effetto Liquid Glass */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 20px;
        }

        /* Area Touchpad */
        #touchpad {
            width: 90%;
            height: 60%;
            margin-bottom: 20px;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgba(255, 255, 255, 0.3);
            font-weight: 300;
            letter-spacing: 2px;
            transition: box-shadow 0.3s ease;
        }

        #touchpad:active {
            box-shadow: 0 0 20px var(--accent);
            border-color: var(--accent);
        }

        /* Contenitore Pulsanti */
        .buttons-container {
            width: 90%;
            height: 15%;
            display: flex;
            justify-content: space-between;
        }

        .mouse-btn {
            width: 48%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            color: white;
            transition: all 0.1s;
            cursor: pointer;
        }

        .mouse-btn:active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(0.95);
        }

        /* Status indicator */
        #status {
            position: absolute;
            top: 20px;
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
        }

    </style>
</head>
<body>

    <div id="status">Disconnesso</div>

    <div id="touchpad" class="glass-panel">
        TOUCH AREA
    </div>

    <div class="buttons-container">
        <div id="btn-left" class="glass-panel mouse-btn">L</div>
        <div id="btn-right" class="glass-panel mouse-btn">R</div>
    </div>

    <script>
        // Logica WebSocket
        const statusDiv = document.getElementById('status');
        // Sostituisci con l'IP locale del tuo PC
        const ws = new WebSocket('ws://192.168.1.X:8765'); 

        ws.onopen = () => {
            statusDiv.innerText = "Connesso - Liquid Glass Ready";
            statusDiv.style.color = "#00ff88";
        };

        ws.onclose = () => {
            statusDiv.innerText = "Disconnesso";
            statusDiv.style.color = "#ff4444";
        };

        // Logica Touchpad
        const touchpad = document.getElementById('touchpad');
        let lastX = 0, lastY = 0;

        touchpad.addEventListener('touchstart', (e) => {
            lastX = e.touches[0].clientX;
            lastY = e.touches[0].clientY;
        }, {passive: false});

        touchpad.addEventListener('touchmove', (e) => {
            e.preventDefault(); // Evita scroll della pagina
            const currentX = e.touches[0].clientX;
            const currentY = e.touches[0].clientY;

            const deltaX = currentX - lastX;
            const deltaY = currentY - lastY;

            // Invia movimento al server
            if(ws.readyState === WebSocket.OPEN) {
                ws.send(JSON.stringify({type: 'move', x: deltaX, y: deltaY}));
            }

            lastX = currentX;
            lastY = currentY;
        }, {passive: false});

        // Click
        document.getElementById('btn-left').addEventListener('click', () => {
            if(ws.readyState === WebSocket.OPEN) ws.send(JSON.stringify({type: 'click', btn: 'left'}));
        });

        document.getElementById('btn-right').addEventListener('click', () => {
            if(ws.readyState === WebSocket.OPEN) ws.send(JSON.stringify({type: 'click', btn: 'right'}));
        });
    </script>
</body>
</html>
